<template>
  <v-dialog
    v-model="active"
    max-width="500px"
  >
    <template v-slot:activator="{ on, attrs }">
      <v-btn
        v-haptic
        ripple
        text
        outlined
        class="flex-grow-1"
        v-bind="attrs"
        v-on="on"
      >
        <v-icon left>
          mdi-settings
        </v-icon>
        {{ $t('menu.settings.name') }}
      </v-btn>
    </template>
    <v-card :color="`${dark ? 'blue-grey darken-3' : 'white'}`">
      <v-card-title class="headline">
        <v-icon left>
          mdi-settings
        </v-icon>
        {{ $t('menu.settings.name') }}
      </v-card-title>

      <v-card-text>
        <v-container class="pt-0">
          <v-row class="flex-column">
            <Subheader>
              {{ $t('settings.category.appearance') }}
            </Subheader>
            <ThemeSwitcher class="mb-2" />

            <LocaleSwitcher
              v-if="!$env.isApp"
              class="mb-2"
            />

            <OptimizationSwitcher
              v-if="!$env.isApp"
              class="mb-2"
            />

            <PushNotificationSettings v-if="false">
              <template #default="{ on }">
                <v-btn
                  v-if="$env.isApp"
                  v-haptic
                  large
                  block
                  color="indigo"
                  class="mb-3"
                  v-on="on"
                >
                  <v-icon left>
                    mdi-bell
                  </v-icon>
                  推送通知设置...
                </v-btn>
              </template>
            </PushNotificationSettings>

            <v-btn
              v-if="$env.isApp"
              v-haptic
              depressed

              block
              color="primary"
              @click="openBundleSettings"
            >
              <v-icon left>
                mdi-settings
              </v-icon>
              语言与隐私设置
            </v-btn>

            <DataManager
              v-if="active"
              class="mt-2"
            />
          </v-row>
        </v-container>
      </v-card-text>

      <v-divider />

      <v-card-actions>
        <v-spacer />
        <v-btn
          v-haptic
          text
          @click="active = false"
        >
          {{ $t('meta.dialog.close') }}
        </v-btn>
      </v-card-actions>
    </v-card>
  </v-dialog>
</template>

<script>
import ThemeSwitcher from '@/components/drawer/ThemeSwitcher'
import LocaleSwitcher from '@/components/drawer/LocaleSwitcher'
import Theme from '@/mixins/Theme'
import OptimizationSwitcher from '@/components/drawer/OptimizationSwitcher'
import DataManager from '@/components/drawer/DataManager'
import Subheader from '@/components/global/Subheader'
import penguin from '@/utils/native/penguin'
import PushNotificationSettings from '@/components/drawer/PushNotificationSettings'
export default {
  name: 'SettingsDialog',
  components: { PushNotificationSettings, Subheader, DataManager, OptimizationSwitcher, LocaleSwitcher, ThemeSwitcher },
  mixins: [Theme],
  data () {
    return {
      active: false
    }
  },
  methods: {
    openBundleSettings: penguin.openBundleSettings
  }
}
</script>

<style scoped>

</style>
